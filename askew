#!/usr/bin/env ruby

require 'yaml'
#require 'todo-txt'
require 'pry'
require 'thor'

require_relative 'lib/startup.rb'
require_relative 'lib/config.rb'
require_relative 'lib/string.rb'
require_relative 'lib/patternhelpers.rb'
require_relative 'lib/task.rb'
require_relative 'lib/file.rb'
require_relative 'lib/options.rb'
require_relative 'lib/tasklist.rb'
require_relative 'lib/commands/version.rb'
require_relative 'lib/commands/task.rb'

module Askew

  VERSION_MAJOR    = '0'
  VERSION_MINOR    = '0'
  VERSION_PATCH    = '1'

  VERSION = VERSION_MAJOR + "." +  VERSION_MINOR + "." + VERSION_PATCH

  class CLI < Thor

    @@version = "0.0.1"
    
    class_option 'config', :banner => 'PATH_TO_FILE', :aliases => '-c', :type => :string, :default => nil 

    desc "version" ,  "Display the application version"
    subcommand "version", Version

    desc "colortest", "Print pretty colors to the screen"
    def colortest
      puts "Color should be red".red
      puts "Non bold" + " text should be bold".bold + " Non Bold again."
    end

    desc "task", "List all the tasks"
    subcommand "task", Askew::Task

    default_task :task 

    def initialize(*args)
      super
      Startup.process_config options[:config]
    end

    no_commands do
      def _get_config_arg
        options[:config]
      end
    end 

  end

  # Start the program
  CLI.start(ARGV)
  exit 0

end
