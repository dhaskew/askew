#!/usr/bin/env ruby

require 'yaml'
require 'todo-txt'
require 'pry'
require 'thor'

require_relative 'lib/startup.rb'
require_relative 'lib/config.rb'
require_relative 'lib/string.rb'

class List < Thor
  
  desc "all", "List all tasks"
  def all
    begin
      list = Todo::List.new Startup.config.todo_file
      #puts list.by_priority "A"
      #binding.pry
      #puts list.sort_by { |task| task.priority }
      puts list.sort_by {|item| [item.priority ? 0 : 1, item.priority || 0]} # list by priorty with nulls at the end
    rescue
      puts "Unable to load your todo list."
    end
  end
  
  default_task :all

end

class Askew < Thor

  @@version = "0.0.1"

  map %w[--version -v] => :_print_version

  desc "--version, -v", "print the version"
  def _print_version
    puts @@version 
  end

  desc "hello NAME", "Say hello to NAME"
  def hello(name)
    puts "Hello #{name}"
  end

  desc "colortest", "Print pretty colors to the screen"
  def colortest
    puts "Color should be red".red
    puts "Non bold" + " text should be bold".bold + " Non Bold again."
  end

  desc "list", "List all the tasks"
  subcommand "list", List 

  default_task :list 
end

# Start the program
Startup.process_config
Askew.start(ARGV)
exit 0

